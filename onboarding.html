<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personaliza tu Plan - GestiÃ³n del Tiempo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Poppins', sans-serif; }
        .gradient-text { background: linear-gradient(135deg, #3b82f6, #8b5cf6, #ec4899); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .gradient-bg { background: linear-gradient(135deg, #3b82f6, #8b5cf6); }
        .option-card { transition: all 0.3s ease; }
        .option-card:hover { transform: translateY(-2px); }
        .option-card.selected { border-color: #8b5cf6; background: linear-gradient(135deg, #ede9fe, #fae8ff); }
        .option-card.selected .check-icon { display: flex; }
        .check-icon { display: none; }
        .step-dot.active { background: linear-gradient(135deg, #3b82f6, #8b5cf6); }
        .step-dot.completed { background: #22c55e; }
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        .time-btn.selected { background: linear-gradient(135deg, #3b82f6, #8b5cf6); color: white; border-color: transparent; }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50">

    <!-- Progress Header -->
    <header class="bg-white/80 backdrop-blur-sm border-b border-gray-100 sticky top-0 z-50">
        <div class="max-w-3xl mx-auto px-4 py-4">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center gap-2">
                    <span class="text-2xl">â°</span>
                    <span class="font-bold gradient-text">GestiÃ³n del Tiempo</span>
                </div>
                <span id="stepIndicator" class="text-sm text-gray-500">Paso 1 de 5</span>
            </div>
            <!-- Progress bar -->
            <div class="flex gap-2">
                <div id="dot1" class="step-dot w-full h-2 rounded-full bg-gray-200 active"></div>
                <div id="dot2" class="step-dot w-full h-2 rounded-full bg-gray-200"></div>
                <div id="dot3" class="step-dot w-full h-2 rounded-full bg-gray-200"></div>
                <div id="dot4" class="step-dot w-full h-2 rounded-full bg-gray-200"></div>
                <div id="dot5" class="step-dot w-full h-2 rounded-full bg-gray-200"></div>
            </div>
        </div>
    </header>

    <main class="max-w-3xl mx-auto px-4 py-8">
        <!-- Step 1: Objetivo Principal -->
        <div id="step1" class="step-content fade-in">
            <div class="text-center mb-8">
                <span class="text-6xl mb-4 block">ğŸ¯</span>
                <h1 class="text-3xl font-bold text-gray-900 mb-2">Â¿CuÃ¡l es tu objetivo principal?</h1>
                <p class="text-gray-600">Selecciona el que mejor describa lo que quieres lograr</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="option-card cursor-pointer p-5 bg-white rounded-2xl border-2 border-gray-200 relative" onclick="selectOption('goal', 'fitness', this)">
                    <div class="check-icon absolute top-3 right-3 w-6 h-6 bg-purple-500 rounded-full items-center justify-center text-white text-sm">âœ“</div>
                    <span class="text-4xl mb-3 block">ğŸ’ª</span>
                    <h3 class="font-bold text-gray-900">TransformaciÃ³n FÃ­sica</h3>
                    <p class="text-sm text-gray-500 mt-1">Perder peso, ganar mÃºsculo, definir cuerpo</p>
                </div>
                <div class="option-card cursor-pointer p-5 bg-white rounded-2xl border-2 border-gray-200 relative" onclick="selectOption('goal', 'learning', this)">
                    <div class="check-icon absolute top-3 right-3 w-6 h-6 bg-purple-500 rounded-full items-center justify-center text-white text-sm">âœ“</div>
                    <span class="text-4xl mb-3 block">ğŸ“š</span>
                    <h3 class="font-bold text-gray-900">Aprender algo nuevo</h3>
                    <p class="text-sm text-gray-500 mt-1">Idiomas, habilidades, certificaciones</p>
                </div>
                <div class="option-card cursor-pointer p-5 bg-white rounded-2xl border-2 border-gray-200 relative" onclick="selectOption('goal', 'productivity', this)">
                    <div class="check-icon absolute top-3 right-3 w-6 h-6 bg-purple-500 rounded-full items-center justify-center text-white text-sm">âœ“</div>
                    <span class="text-4xl mb-3 block">ğŸ“ˆ</span>
                    <h3 class="font-bold text-gray-900">Ser mÃ¡s productivo</h3>
                    <p class="text-sm text-gray-500 mt-1">Organizar tiempo, lograr mÃ¡s cada dÃ­a</p>
                </div>
                <div class="option-card cursor-pointer p-5 bg-white rounded-2xl border-2 border-gray-200 relative" onclick="selectOption('goal', 'business', this)">
                    <div class="check-icon absolute top-3 right-3 w-6 h-6 bg-purple-500 rounded-full items-center justify-center text-white text-sm">âœ“</div>
                    <span class="text-4xl mb-3 block">ğŸ’¼</span>
                    <h3 class="font-bold text-gray-900">Emprender / Negocio</h3>
                    <p class="text-sm text-gray-500 mt-1">Lanzar proyecto, hacer crecer negocio</p>
                </div>
                <div class="option-card cursor-pointer p-5 bg-white rounded-2xl border-2 border-gray-200 relative" onclick="selectOption('goal', 'competition', this)">
                    <div class="check-icon absolute top-3 right-3 w-6 h-6 bg-purple-500 rounded-full items-center justify-center text-white text-sm">âœ“</div>
                    <span class="text-4xl mb-3 block">ğŸ‘‘</span>
                    <h3 class="font-bold text-gray-900">Competencia / Concurso</h3>
                    <p class="text-sm text-gray-500 mt-1">Miss, deportes, certÃ¡menes, oposiciones</p>
                </div>
                <div class="option-card cursor-pointer p-5 bg-white rounded-2xl border-2 border-gray-200 relative" onclick="selectOption('goal', 'wellness', this)">
                    <div class="check-icon absolute top-3 right-3 w-6 h-6 bg-purple-500 rounded-full items-center justify-center text-white text-sm">âœ“</div>
                    <span class="text-4xl mb-3 block">ğŸ§˜</span>
                    <h3 class="font-bold text-gray-900">Bienestar personal</h3>
                    <p class="text-sm text-gray-500 mt-1">Reducir estrÃ©s, mejorar salud mental</p>
                </div>
            </div>
        </div>

        <!-- Step 2: Horarios -->
        <div id="step2" class="step-content hidden fade-in">
            <div class="text-center mb-8">
                <span class="text-6xl mb-4 block">â°</span>
                <h1 class="text-3xl font-bold text-gray-900 mb-2">Â¿CuÃ¡les son tus horarios?</h1>
                <p class="text-gray-600">Esto nos ayuda a crear un plan que se adapte a tu vida</p>
            </div>

            <div class="space-y-6 bg-white rounded-2xl p-6 border border-gray-200">
                <div>
                    <label class="block font-medium text-gray-700 mb-3">ğŸŒ… Â¿A quÃ© hora despiertas normalmente?</label>
                    <div class="flex flex-wrap gap-2">
                        <button class="time-btn px-4 py-2 border-2 border-gray-200 rounded-xl hover:border-purple-300 transition" onclick="selectTime('wakeUp', '05:00', this)">5:00</button>
                        <button class="time-btn px-4 py-2 border-2 border-gray-200 rounded-xl hover:border-purple-300 transition" onclick="selectTime('wakeUp', '06:00', this)">6:00</button>
                        <button class="time-btn px-4 py-2 border-2 border-gray-200 rounded-xl hover:border-purple-300 transition selected" onclick="selectTime('wakeUp', '07:00', this)">7:00</button>
                        <button class="time-btn px-4 py-2 border-2 border-gray-200 rounded-xl hover:border-purple-300 transition" onclick="selectTime('wakeUp', '08:00', this)">8:00</button>
                        <button class="time-btn px-4 py-2 border-2 border-gray-200 rounded-xl hover:border-purple-300 transition" onclick="selectTime('wakeUp', '09:00', this)">9:00</button>
                    </div>
                </div>

                <div>
                    <label class="block font-medium text-gray-700 mb-3">ğŸŒ™ Â¿A quÃ© hora te acuestas?</label>
                    <div class="flex flex-wrap gap-2">
                        <button class="time-btn px-4 py-2 border-2 border-gray-200 rounded-xl hover:border-purple-300 transition" onclick="selectTime('sleep', '21:00', this)">21:00</button>
                        <button class="time-btn px-4 py-2 border-2 border-gray-200 rounded-xl hover:border-purple-300 transition selected" onclick="selectTime('sleep', '22:00', this)">22:00</button>
                        <button class="time-btn px-4 py-2 border-2 border-gray-200 rounded-xl hover:border-purple-300 transition" onclick="selectTime('sleep', '23:00', this)">23:00</button>
                        <button class="time-btn px-4 py-2 border-2 border-gray-200 rounded-xl hover:border-purple-300 transition" onclick="selectTime('sleep', '00:00', this)">00:00</button>
                    </div>
                </div>

                <div>
                    <label class="block font-medium text-gray-700 mb-3">ğŸ’¼ Â¿Trabajas o estudias?</label>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-2">
                        <button class="time-btn px-4 py-2 border-2 border-gray-200 rounded-xl hover:border-purple-300 transition" onclick="selectTime('occupation', 'fulltime', this)">Tiempo completo</button>
                        <button class="time-btn px-4 py-2 border-2 border-gray-200 rounded-xl hover:border-purple-300 transition" onclick="selectTime('occupation', 'parttime', this)">Medio tiempo</button>
                        <button class="time-btn px-4 py-2 border-2 border-gray-200 rounded-xl hover:border-purple-300 transition" onclick="selectTime('occupation', 'student', this)">Estudiante</button>
                        <button class="time-btn px-4 py-2 border-2 border-gray-200 rounded-xl hover:border-purple-300 transition" onclick="selectTime('occupation', 'flexible', this)">Horario flexible</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 3: Ejercicio -->
        <div id="step3" class="step-content hidden fade-in">
            <div class="text-center mb-8">
                <span class="text-6xl mb-4 block">ğŸ’ª</span>
                <h1 class="text-3xl font-bold text-gray-900 mb-2">Â¿QuÃ© tipo de ejercicio prefieres?</h1>
                <p class="text-gray-600">Selecciona las opciones que te interesen</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="option-card cursor-pointer p-5 bg-white rounded-2xl border-2 border-gray-200 relative" onclick="toggleMultiOption('exercise', 'gym', this)">
                    <div class="check-icon absolute top-3 right-3 w-6 h-6 bg-purple-500 rounded-full items-center justify-center text-white text-sm">âœ“</div>
                    <span class="text-4xl mb-3 block">ğŸ‹ï¸</span>
                    <h3 class="font-bold text-gray-900">Gimnasio</h3>
                    <p class="text-sm text-gray-500 mt-1">Pesas, mÃ¡quinas, entrenamiento de fuerza</p>
                </div>
                <div class="option-card cursor-pointer p-5 bg-white rounded-2xl border-2 border-gray-200 relative" onclick="toggleMultiOption('exercise', 'cardio', this)">
                    <div class="check-icon absolute top-3 right-3 w-6 h-6 bg-purple-500 rounded-full items-center justify-center text-white text-sm">âœ“</div>
                    <span class="text-4xl mb-3 block">ğŸƒ</span>
                    <h3 class="font-bold text-gray-900">Cardio</h3>
                    <p class="text-sm text-gray-500 mt-1">Correr, bicicleta, HIIT</p>
                </div>
                <div class="option-card cursor-pointer p-5 bg-white rounded-2xl border-2 border-gray-200 relative" onclick="toggleMultiOption('exercise', 'yoga', this)">
                    <div class="check-icon absolute top-3 right-3 w-6 h-6 bg-purple-500 rounded-full items-center justify-center text-white text-sm">âœ“</div>
                    <span class="text-4xl mb-3 block">ğŸ§˜</span>
                    <h3 class="font-bold text-gray-900">Yoga / Pilates</h3>
                    <p class="text-sm text-gray-500 mt-1">Flexibilidad, equilibrio, relajaciÃ³n</p>
                </div>
                <div class="option-card cursor-pointer p-5 bg-white rounded-2xl border-2 border-gray-200 relative" onclick="toggleMultiOption('exercise', 'dance', this)">
                    <div class="check-icon absolute top-3 right-3 w-6 h-6 bg-purple-500 rounded-full items-center justify-center text-white text-sm">âœ“</div>
                    <span class="text-4xl mb-3 block">ğŸ’ƒ</span>
                    <h3 class="font-bold text-gray-900">Baile / Zumba</h3>
                    <p class="text-sm text-gray-500 mt-1">Clases de baile, aerÃ³bicos</p>
                </div>
                <div class="option-card cursor-pointer p-5 bg-white rounded-2xl border-2 border-gray-200 relative" onclick="toggleMultiOption('exercise', 'sports', this)">
                    <div class="check-icon absolute top-3 right-3 w-6 h-6 bg-purple-500 rounded-full items-center justify-center text-white text-sm">âœ“</div>
                    <span class="text-4xl mb-3 block">âš½</span>
                    <h3 class="font-bold text-gray-900">Deportes</h3>
                    <p class="text-sm text-gray-500 mt-1">FÃºtbol, tenis, nataciÃ³n, etc.</p>
                </div>
                <div class="option-card cursor-pointer p-5 bg-white rounded-2xl border-2 border-gray-200 relative" onclick="toggleMultiOption('exercise', 'none', this)">
                    <div class="check-icon absolute top-3 right-3 w-6 h-6 bg-purple-500 rounded-full items-center justify-center text-white text-sm">âœ“</div>
                    <span class="text-4xl mb-3 block">ğŸš¶</span>
                    <h3 class="font-bold text-gray-900">No hago ejercicio</h3>
                    <p class="text-sm text-gray-500 mt-1">Pero quiero empezar con algo suave</p>
                </div>
            </div>
        </div>

        <!-- Step 4: HÃ¡bitos -->
        <div id="step4" class="step-content hidden fade-in">
            <div class="text-center mb-8">
                <span class="text-6xl mb-4 block">âœ¨</span>
                <h1 class="text-3xl font-bold text-gray-900 mb-2">Â¿QuÃ© hÃ¡bitos quieres desarrollar?</h1>
                <p class="text-gray-600">Selecciona todos los que te interesen</p>
            </div>

            <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                <div class="option-card cursor-pointer p-4 bg-white rounded-xl border-2 border-gray-200 relative text-center" onclick="toggleMultiOption('habits', 'meditation', this)">
                    <div class="check-icon absolute top-2 right-2 w-5 h-5 bg-purple-500 rounded-full items-center justify-center text-white text-xs">âœ“</div>
                    <span class="text-2xl">ğŸ§˜</span>
                    <p class="text-sm font-medium mt-1">MeditaciÃ³n</p>
                </div>
                <div class="option-card cursor-pointer p-4 bg-white rounded-xl border-2 border-gray-200 relative text-center" onclick="toggleMultiOption('habits', 'reading', this)">
                    <div class="check-icon absolute top-2 right-2 w-5 h-5 bg-purple-500 rounded-full items-center justify-center text-white text-xs">âœ“</div>
                    <span class="text-2xl">ğŸ“–</span>
                    <p class="text-sm font-medium mt-1">Lectura</p>
                </div>
                <div class="option-card cursor-pointer p-4 bg-white rounded-xl border-2 border-gray-200 relative text-center" onclick="toggleMultiOption('habits', 'journaling', this)">
                    <div class="check-icon absolute top-2 right-2 w-5 h-5 bg-purple-500 rounded-full items-center justify-center text-white text-xs">âœ“</div>
                    <span class="text-2xl">ğŸ“</span>
                    <p class="text-sm font-medium mt-1">Journaling</p>
                </div>
                <div class="option-card cursor-pointer p-4 bg-white rounded-xl border-2 border-gray-200 relative text-center" onclick="toggleMultiOption('habits', 'languages', this)">
                    <div class="check-icon absolute top-2 right-2 w-5 h-5 bg-purple-500 rounded-full items-center justify-center text-white text-xs">âœ“</div>
                    <span class="text-2xl">ğŸŒ</span>
                    <p class="text-sm font-medium mt-1">Idiomas</p>
                </div>
                <div class="option-card cursor-pointer p-4 bg-white rounded-xl border-2 border-gray-200 relative text-center" onclick="toggleMultiOption('habits', 'water', this)">
                    <div class="check-icon absolute top-2 right-2 w-5 h-5 bg-purple-500 rounded-full items-center justify-center text-white text-xs">âœ“</div>
                    <span class="text-2xl">ğŸ’§</span>
                    <p class="text-sm font-medium mt-1">Beber agua</p>
                </div>
                <div class="option-card cursor-pointer p-4 bg-white rounded-xl border-2 border-gray-200 relative text-center" onclick="toggleMultiOption('habits', 'skincare', this)">
                    <div class="check-icon absolute top-2 right-2 w-5 h-5 bg-purple-500 rounded-full items-center justify-center text-white text-xs">âœ“</div>
                    <span class="text-2xl">ğŸ§´</span>
                    <p class="text-sm font-medium mt-1">Skincare</p>
                </div>
                <div class="option-card cursor-pointer p-4 bg-white rounded-xl border-2 border-gray-200 relative text-center" onclick="toggleMultiOption('habits', 'gratitude', this)">
                    <div class="check-icon absolute top-2 right-2 w-5 h-5 bg-purple-500 rounded-full items-center justify-center text-white text-xs">âœ“</div>
                    <span class="text-2xl">ğŸ™</span>
                    <p class="text-sm font-medium mt-1">Gratitud</p>
                </div>
                <div class="option-card cursor-pointer p-4 bg-white rounded-xl border-2 border-gray-200 relative text-center" onclick="toggleMultiOption('habits', 'nosugar', this)">
                    <div class="check-icon absolute top-2 right-2 w-5 h-5 bg-purple-500 rounded-full items-center justify-center text-white text-xs">âœ“</div>
                    <span class="text-2xl">ğŸš«</span>
                    <p class="text-sm font-medium mt-1">Sin azÃºcar</p>
                </div>
                <div class="option-card cursor-pointer p-4 bg-white rounded-xl border-2 border-gray-200 relative text-center" onclick="toggleMultiOption('habits', 'sleep', this)">
                    <div class="check-icon absolute top-2 right-2 w-5 h-5 bg-purple-500 rounded-full items-center justify-center text-white text-xs">âœ“</div>
                    <span class="text-2xl">ğŸ˜´</span>
                    <p class="text-sm font-medium mt-1">Dormir bien</p>
                </div>
                <div class="option-card cursor-pointer p-4 bg-white rounded-xl border-2 border-gray-200 relative text-center" onclick="toggleMultiOption('habits', 'socialmedia', this)">
                    <div class="check-icon absolute top-2 right-2 w-5 h-5 bg-purple-500 rounded-full items-center justify-center text-white text-xs">âœ“</div>
                    <span class="text-2xl">ğŸ“±</span>
                    <p class="text-sm font-medium mt-1">Redes sociales</p>
                </div>
                <div class="option-card cursor-pointer p-4 bg-white rounded-xl border-2 border-gray-200 relative text-center" onclick="toggleMultiOption('habits', 'networking', this)">
                    <div class="check-icon absolute top-2 right-2 w-5 h-5 bg-purple-500 rounded-full items-center justify-center text-white text-xs">âœ“</div>
                    <span class="text-2xl">ğŸ¤</span>
                    <p class="text-sm font-medium mt-1">Networking</p>
                </div>
                <div class="option-card cursor-pointer p-4 bg-white rounded-xl border-2 border-gray-200 relative text-center" onclick="toggleMultiOption('habits', 'finances', this)">
                    <div class="check-icon absolute top-2 right-2 w-5 h-5 bg-purple-500 rounded-full items-center justify-center text-white text-xs">âœ“</div>
                    <span class="text-2xl">ğŸ’°</span>
                    <p class="text-sm font-medium mt-1">Finanzas</p>
                </div>
            </div>
        </div>

        <!-- Step 5: DuraciÃ³n y ConfirmaciÃ³n -->
        <div id="step5" class="step-content hidden fade-in">
            <div class="text-center mb-8">
                <span class="text-6xl mb-4 block">ğŸ“…</span>
                <h1 class="text-3xl font-bold text-gray-900 mb-2">Â¿CuÃ¡nto tiempo durarÃ¡ tu plan?</h1>
                <p class="text-gray-600">Elige la duraciÃ³n de tu transformaciÃ³n</p>
            </div>

            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                <div class="option-card cursor-pointer p-5 bg-white rounded-2xl border-2 border-gray-200 relative text-center" onclick="selectOption('duration', 30, this)">
                    <div class="check-icon absolute top-3 right-3 w-6 h-6 bg-purple-500 rounded-full items-center justify-center text-white text-sm">âœ“</div>
                    <span class="text-3xl font-bold text-gray-900">30</span>
                    <p class="text-sm text-gray-500">dÃ­as</p>
                    <p class="text-xs text-purple-600 mt-2">4 semanas</p>
                </div>
                <div class="option-card cursor-pointer p-5 bg-white rounded-2xl border-2 border-gray-200 relative text-center" onclick="selectOption('duration', 60, this)">
                    <div class="check-icon absolute top-3 right-3 w-6 h-6 bg-purple-500 rounded-full items-center justify-center text-white text-sm">âœ“</div>
                    <span class="text-3xl font-bold text-gray-900">60</span>
                    <p class="text-sm text-gray-500">dÃ­as</p>
                    <p class="text-xs text-purple-600 mt-2">8 semanas</p>
                </div>
                <div class="option-card cursor-pointer p-5 bg-white rounded-2xl border-2 border-gray-200 relative text-center" onclick="selectOption('duration', 90, this)">
                    <div class="check-icon absolute top-3 right-3 w-6 h-6 bg-purple-500 rounded-full items-center justify-center text-white text-sm">âœ“</div>
                    <span class="text-3xl font-bold text-gray-900">90</span>
                    <p class="text-sm text-gray-500">dÃ­as</p>
                    <p class="text-xs text-purple-600 mt-2">12 semanas</p>
                </div>
                <div class="option-card cursor-pointer p-5 bg-white rounded-2xl border-2 border-gray-200 relative text-center" onclick="selectOption('duration', 180, this)">
                    <div class="check-icon absolute top-3 right-3 w-6 h-6 bg-purple-500 rounded-full items-center justify-center text-white text-sm">âœ“</div>
                    <span class="text-3xl font-bold text-gray-900">180</span>
                    <p class="text-sm text-gray-500">dÃ­as</p>
                    <p class="text-xs text-purple-600 mt-2">6 meses</p>
                </div>
            </div>

            <!-- Summary -->
            <div class="bg-white rounded-2xl p-6 border border-gray-200">
                <h3 class="font-bold text-gray-900 mb-4">ğŸ“‹ Resumen de tu plan</h3>
                <div id="planSummary" class="space-y-3 text-sm">
                    <!-- Will be populated dynamically -->
                </div>
            </div>
        </div>

        <!-- Navigation Buttons -->
        <div class="flex justify-between mt-8">
            <button id="prevBtn" onclick="prevStep()" class="px-6 py-3 bg-gray-100 text-gray-600 rounded-xl font-medium hover:bg-gray-200 transition hidden">
                â† Anterior
            </button>
            <button id="nextBtn" onclick="nextStep()" class="px-8 py-3 gradient-bg text-white rounded-xl font-semibold hover:opacity-90 transition shadow-lg shadow-purple-200 ml-auto">
                Siguiente â†’
            </button>
            <button id="finishBtn" onclick="generatePlan()" class="px-8 py-3 gradient-bg text-white rounded-xl font-semibold hover:opacity-90 transition shadow-lg shadow-purple-200 ml-auto hidden">
                âœ¨ Crear mi plan personalizado
            </button>
        </div>
    </main>

    <!-- Load Supabase API for fetching templates -->
    <script src="src/js/services/supabase-api.js"></script>

    <script>
        // Check if user is logged in
        const currentUser = JSON.parse(localStorage.getItem('gestion-currentUser'));
        if (!currentUser) {
            window.location.href = 'login.html';
        }

        let currentStep = 1;
        const totalSteps = 5;

        // Cloud templates from backoffice (will be loaded on init)
        let cloudTemplates = null;

        const userPreferences = {
            goal: null,
            wakeUp: '07:00',
            sleep: '22:00',
            occupation: null,
            exercise: [],
            habits: [],
            duration: 60
        };

        function selectOption(key, value, element) {
            userPreferences[key] = value;

            // Remove selected from siblings
            element.parentElement.querySelectorAll('.option-card').forEach(card => {
                card.classList.remove('selected');
            });
            element.classList.add('selected');
        }

        function selectTime(key, value, element) {
            userPreferences[key] = value;

            // Remove selected from siblings in same group
            element.parentElement.querySelectorAll('.time-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            element.classList.add('selected');
        }

        function toggleMultiOption(key, value, element) {
            const index = userPreferences[key].indexOf(value);
            if (index > -1) {
                userPreferences[key].splice(index, 1);
                element.classList.remove('selected');
            } else {
                // If selecting "none" for exercise, clear others
                if (key === 'exercise' && value === 'none') {
                    userPreferences[key] = ['none'];
                    element.parentElement.querySelectorAll('.option-card').forEach(card => {
                        card.classList.remove('selected');
                    });
                } else if (key === 'exercise' && userPreferences[key].includes('none')) {
                    userPreferences[key] = [];
                    element.parentElement.querySelector('.option-card.selected')?.classList.remove('selected');
                }
                userPreferences[key].push(value);
                element.classList.add('selected');
            }
        }

        function updateProgress() {
            for (let i = 1; i <= totalSteps; i++) {
                const dot = document.getElementById(`dot${i}`);
                dot.classList.remove('active', 'completed');
                if (i < currentStep) {
                    dot.classList.add('completed');
                } else if (i === currentStep) {
                    dot.classList.add('active');
                }
            }
            document.getElementById('stepIndicator').textContent = `Paso ${currentStep} de ${totalSteps}`;
        }

        function showStep(step) {
            document.querySelectorAll('.step-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(`step${step}`).classList.remove('hidden');
            document.getElementById(`step${step}`).classList.add('fade-in');

            // Update buttons
            document.getElementById('prevBtn').classList.toggle('hidden', step === 1);
            document.getElementById('nextBtn').classList.toggle('hidden', step === totalSteps);
            document.getElementById('finishBtn').classList.toggle('hidden', step !== totalSteps);

            // Update summary on last step
            if (step === totalSteps) {
                updateSummary();
            }

            updateProgress();
        }

        function nextStep() {
            // Validation
            if (currentStep === 1 && !userPreferences.goal) {
                alert('Por favor selecciona tu objetivo principal');
                return;
            }

            if (currentStep < totalSteps) {
                currentStep++;
                showStep(currentStep);
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
            }
        }

        function updateSummary() {
            const goalLabels = {
                fitness: 'ğŸ’ª TransformaciÃ³n fÃ­sica',
                learning: 'ğŸ“š Aprendizaje',
                productivity: 'ğŸ“ˆ Productividad',
                business: 'ğŸ’¼ Emprendimiento',
                competition: 'ğŸ‘‘ Competencia',
                wellness: 'ğŸ§˜ Bienestar'
            };

            const exerciseLabels = {
                gym: 'ğŸ‹ï¸ Gimnasio',
                cardio: 'ğŸƒ Cardio',
                yoga: 'ğŸ§˜ Yoga/Pilates',
                dance: 'ğŸ’ƒ Baile',
                sports: 'âš½ Deportes',
                none: 'ğŸš¶ Empezar suave'
            };

            const habitLabels = {
                meditation: 'ğŸ§˜ MeditaciÃ³n',
                reading: 'ğŸ“– Lectura',
                journaling: 'ğŸ“ Journaling',
                languages: 'ğŸŒ Idiomas',
                water: 'ğŸ’§ Beber agua',
                skincare: 'ğŸ§´ Skincare',
                gratitude: 'ğŸ™ Gratitud',
                nosugar: 'ğŸš« Sin azÃºcar',
                sleep: 'ğŸ˜´ Dormir bien',
                socialmedia: 'ğŸ“± Redes sociales',
                networking: 'ğŸ¤ Networking',
                finances: 'ğŸ’° Finanzas'
            };

            const summary = document.getElementById('planSummary');
            summary.innerHTML = `
                <div class="flex justify-between py-2 border-b border-gray-100">
                    <span class="text-gray-500">Objetivo</span>
                    <span class="font-medium">${goalLabels[userPreferences.goal] || 'No seleccionado'}</span>
                </div>
                <div class="flex justify-between py-2 border-b border-gray-100">
                    <span class="text-gray-500">Horario</span>
                    <span class="font-medium">${userPreferences.wakeUp} - ${userPreferences.sleep}</span>
                </div>
                <div class="flex justify-between py-2 border-b border-gray-100">
                    <span class="text-gray-500">Ejercicio</span>
                    <span class="font-medium">${userPreferences.exercise.map(e => exerciseLabels[e]).join(', ') || 'No seleccionado'}</span>
                </div>
                <div class="flex justify-between py-2 border-b border-gray-100">
                    <span class="text-gray-500">HÃ¡bitos</span>
                    <span class="font-medium text-right max-w-[200px]">${userPreferences.habits.map(h => habitLabels[h]).join(', ') || 'Ninguno'}</span>
                </div>
                <div class="flex justify-between py-2">
                    <span class="text-gray-500">DuraciÃ³n</span>
                    <span class="font-medium">${userPreferences.duration || 60} dÃ­as</span>
                </div>
            `;
        }

        function generatePlan() {
            if (!userPreferences.duration) {
                alert('Por favor selecciona la duraciÃ³n del plan');
                return;
            }

            // Save preferences
            const userKey = currentUser.email.replace(/[^a-z0-9]/gi, '_');

            // Update user data
            const users = JSON.parse(localStorage.getItem('gestion-users') || '{}');
            if (users[currentUser.email]) {
                users[currentUser.email].goal = userPreferences.goal;
                users[currentUser.email].duration = userPreferences.duration;
                users[currentUser.email].preferences = userPreferences;
                localStorage.setItem('gestion-users', JSON.stringify(users));
            }

            // Update current user session
            currentUser.goal = userPreferences.goal;
            currentUser.duration = userPreferences.duration;
            currentUser.preferences = userPreferences;
            currentUser.onboardingCompleted = true;
            delete currentUser.needsOnboarding; // Remove flag after completing onboarding
            localStorage.setItem('gestion-currentUser', JSON.stringify(currentUser));

            // Generate custom habits based on preferences
            const customHabits = generateHabits(userPreferences);
            localStorage.setItem(`${userKey}-custom-habits`, JSON.stringify(customHabits));

            // Generate custom gym routines if applicable
            if (userPreferences.exercise.length > 0 && !userPreferences.exercise.includes('none')) {
                const customGym = generateGymRoutines(userPreferences);
                localStorage.setItem(`${userKey}-custom-gym`, JSON.stringify(customGym));
            }

            // Generate weekly goals
            const customGoals = generateWeeklyGoals(userPreferences);
            localStorage.setItem(`${userKey}-custom-goals`, JSON.stringify(customGoals));

            // Redirect to app
            window.location.href = 'app.html';
        }

        function generateHabits(prefs) {
            const habits = [
                { id: 1, icon: 'â˜€ï¸', name: `Despertar ${prefs.wakeUp}` },
                { id: 2, icon: 'ğŸ’§', name: 'Beber agua al despertar' }
            ];

            let id = 3;

            if (prefs.habits.includes('meditation')) {
                habits.push({ id: id++, icon: 'ğŸ§˜', name: 'MeditaciÃ³n 15-30 min' });
            }

            if (prefs.habits.includes('gratitude')) {
                habits.push({ id: id++, icon: 'ğŸ™', name: 'Escribir 3 gratitudes' });
            }

            if (prefs.exercise.length > 0 && !prefs.exercise.includes('none')) {
                habits.push({ id: id++, icon: 'ğŸ’ª', name: 'Ejercicio completado' });
            }

            if (prefs.habits.includes('reading')) {
                habits.push({ id: id++, icon: 'ğŸ“–', name: 'Leer 20-30 min' });
            }

            if (prefs.habits.includes('languages')) {
                habits.push({ id: id++, icon: 'ğŸŒ', name: 'Practicar idioma' });
            }

            if (prefs.habits.includes('journaling')) {
                habits.push({ id: id++, icon: 'ğŸ“', name: 'Escribir en diario' });
            }

            if (prefs.habits.includes('water')) {
                habits.push({ id: id++, icon: 'ğŸ’¦', name: 'Beber 2-3L de agua' });
            }

            if (prefs.habits.includes('skincare')) {
                habits.push({ id: id++, icon: 'ğŸ§´', name: 'Skincare AM/PM' });
            }

            if (prefs.habits.includes('nosugar')) {
                habits.push({ id: id++, icon: 'ğŸ¥—', name: 'AlimentaciÃ³n sin azÃºcar' });
            }

            if (prefs.habits.includes('socialmedia')) {
                habits.push({ id: id++, icon: 'ğŸ“±', name: 'Publicar en redes' });
            }

            if (prefs.habits.includes('networking')) {
                habits.push({ id: id++, icon: 'ğŸ¤', name: 'Hacer networking' });
            }

            if (prefs.habits.includes('finances')) {
                habits.push({ id: id++, icon: 'ğŸ’°', name: 'Revisar finanzas' });
            }

            habits.push({ id: id++, icon: 'ğŸ˜´', name: `Dormir antes de ${prefs.sleep}` });

            return habits;
        }

        function generateGymRoutines(prefs) {
            const routines = {};

            // Determine which exercise type to use
            const exerciseType = prefs.exercise.includes('gym') ? 'gym' :
                                 prefs.exercise.includes('cardio') ? 'cardio' :
                                 prefs.exercise.includes('yoga') ? 'yoga' :
                                 prefs.exercise.includes('dance') ? 'dance' :
                                 prefs.exercise.includes('sports') ? 'sports' : null;

            // Map user goal to exercise goal
            // User goals: fitness, productivity, learning, business, competition, wellness
            // Exercise goals: fitness, competition, wellness, weightloss, muscle, beginner
            const goalMapping = {
                fitness: 'fitness',
                productivity: 'wellness',  // Productivity users get wellness routines
                learning: 'beginner',      // Learning users might be new to exercise
                business: 'fitness',       // Business users get general fitness
                competition: 'competition',
                wellness: 'wellness'
            };
            const exerciseGoal = goalMapping[prefs.goal] || 'fitness';

            // Check if cloud templates have exercise routines for this type + goal combo
            if (cloudTemplates && cloudTemplates.exercises &&
                cloudTemplates.exercises[exerciseType] &&
                cloudTemplates.exercises[exerciseType][exerciseGoal]) {
                // Use cloud templates with goal-specific routines
                const cloudRoutines = cloudTemplates.exercises[exerciseType][exerciseGoal];
                for (let day = 0; day < 7; day++) {
                    if (cloudRoutines[day]) {
                        routines[day] = {
                            name: cloudRoutines[day].name,
                            icon: cloudRoutines[day].icon,
                            exercises: cloudRoutines[day].exercises || []
                        };
                    }
                }
                return routines;
            }

            // Also check old format (without goals) for backwards compatibility
            if (cloudTemplates && cloudTemplates.exercises && cloudTemplates.exercises[exerciseType]) {
                const cloudRoutines = cloudTemplates.exercises[exerciseType];
                // Check if it's the old format (has day indexes directly)
                if (cloudRoutines[0] && !cloudRoutines.fitness) {
                    for (let day = 0; day < 7; day++) {
                        if (cloudRoutines[day]) {
                            routines[day] = {
                                name: cloudRoutines[day].name,
                                icon: cloudRoutines[day].icon,
                                exercises: cloudRoutines[day].exercises || []
                            };
                        }
                    }
                    return routines;
                }
            }

            // Fallback to default routines
            if (prefs.exercise.includes('gym')) {
                routines[0] = { name: 'Descanso Activo', icon: 'ğŸ§˜', exercises: ['Estiramientos 20min', 'Caminata ligera 30min', 'Foam roller 15min'] };
                routines[1] = { name: 'Tren Inferior', icon: 'ğŸ¦µ', exercises: ['Sentadillas 4x12', 'Peso muerto 4x10', 'Prensa 4x12', 'Zancadas 3x12', 'ExtensiÃ³n cuÃ¡driceps 3x15'] };
                routines[2] = { name: 'Tren Superior', icon: 'ğŸ’ª', exercises: ['Press banca 4x10', 'Remo 4x12', 'Press hombro 3x12', 'Curl bÃ­ceps 3x15', 'TrÃ­ceps 3x15'] };
                routines[3] = { name: 'Full Body', icon: 'ğŸ”¥', exercises: ['Sentadilla 3x12', 'Press pecho 3x12', 'Peso muerto 3x10', 'Remo 3x12', 'Plancha 3x30seg'] };
                routines[4] = { name: 'Piernas + Core', icon: 'ğŸ‘', exercises: ['Hip thrust 4x12', 'Sentadilla bÃºlgara 3x10', 'Curl femoral 3x12', 'Crunches 3x20', 'Plancha lateral 3x30seg'] };
                routines[5] = { name: 'Cardio + Fuerza', icon: 'â¤ï¸', exercises: ['HIIT 20min', 'Circuito funcional 3 rondas', 'Abdominales 3x20', 'Estiramientos 10min'] };
                routines[6] = { name: 'Flexibilidad', icon: 'ğŸ§˜', exercises: ['Yoga 45min', 'Estiramientos profundos 20min', 'MeditaciÃ³n con movimiento 15min'] };
            } else if (prefs.exercise.includes('cardio')) {
                routines[0] = { name: 'Descanso', icon: 'ğŸ˜´', exercises: ['Caminata suave 20min', 'Estiramientos 15min'] };
                routines[1] = { name: 'Cardio Moderado', icon: 'ğŸƒ', exercises: ['Correr 30min', 'Estiramientos 10min'] };
                routines[2] = { name: 'HIIT', icon: 'ğŸ”¥', exercises: ['Calentamiento 5min', 'HIIT 20min (30seg on/30seg off)', 'Enfriamiento 5min'] };
                routines[3] = { name: 'Cardio Largo', icon: 'ğŸš´', exercises: ['Bicicleta/Correr 45min', 'Estiramientos 10min'] };
                routines[4] = { name: 'Intervalos', icon: 'âš¡', exercises: ['Calentamiento 5min', 'Intervalos 25min', 'Enfriamiento 5min'] };
                routines[5] = { name: 'Cardio + Core', icon: 'ğŸ’ª', exercises: ['Cardio 20min', 'Abdominales 15min', 'Estiramientos 10min'] };
                routines[6] = { name: 'RecuperaciÃ³n', icon: 'ğŸ§˜', exercises: ['Caminata 30min', 'Yoga suave 20min'] };
            } else if (prefs.exercise.includes('yoga')) {
                routines[0] = { name: 'Descanso', icon: 'ğŸ˜´', exercises: ['MeditaciÃ³n 20min', 'RespiraciÃ³n consciente 10min'] };
                routines[1] = { name: 'Vinyasa Flow', icon: 'ğŸ§˜', exercises: ['Saludo al sol 10min', 'Vinyasa flow 30min', 'Savasana 10min'] };
                routines[2] = { name: 'Fuerza Yoga', icon: 'ğŸ’ª', exercises: ['Power yoga 40min', 'Estiramientos 10min'] };
                routines[3] = { name: 'Flexibilidad', icon: 'ğŸ¤¸', exercises: ['Yin yoga 45min', 'MeditaciÃ³n 15min'] };
                routines[4] = { name: 'Core Yoga', icon: 'ğŸ”¥', exercises: ['Yoga para core 30min', 'Estiramientos 15min'] };
                routines[5] = { name: 'Balance', icon: 'âš–ï¸', exercises: ['Posturas de equilibrio 30min', 'MeditaciÃ³n 15min'] };
                routines[6] = { name: 'Restaurativo', icon: 'ğŸŒ™', exercises: ['Yoga restaurativo 40min', 'Yoga nidra 20min'] };
            } else if (prefs.exercise.includes('dance')) {
                routines[0] = { name: 'Descanso', icon: 'ğŸ˜´', exercises: ['Estiramientos suaves 20min', 'Caminata 20min'] };
                routines[1] = { name: 'Zumba', icon: 'ğŸ’ƒ', exercises: ['Calentamiento 10min', 'Zumba 45min', 'Estiramientos 10min'] };
                routines[2] = { name: 'Baile Cardio', icon: 'ğŸµ', exercises: ['Cardio dance 40min', 'Core 10min', 'Estiramientos 10min'] };
                routines[3] = { name: 'TÃ©cnica', icon: 'ğŸ‘ ', exercises: ['TÃ©cnica de baile 30min', 'CoreografÃ­a 20min', 'Estiramientos 10min'] };
                routines[4] = { name: 'Ritmos Latinos', icon: 'ğŸŒ´', exercises: ['Salsa/Bachata 45min', 'Estiramientos 10min'] };
                routines[5] = { name: 'Dance Fitness', icon: 'ğŸ”¥', exercises: ['Dance workout 40min', 'Abdominales 10min', 'Estiramientos 10min'] };
                routines[6] = { name: 'Stretching', icon: 'ğŸ§˜', exercises: ['Stretching para bailarines 30min', 'Yoga 20min'] };
            } else if (prefs.exercise.includes('sports')) {
                routines[0] = { name: 'Descanso', icon: 'ğŸ˜´', exercises: ['RecuperaciÃ³n activa'] };
                routines[1] = { name: 'TÃ©cnica', icon: 'ğŸ¯', exercises: ['PrÃ¡ctica tÃ©cnica 45min'] };
                routines[2] = { name: 'Fuerza', icon: 'ğŸ’ª', exercises: ['Fuerza 40min'] };
                routines[3] = { name: 'TÃ¡ctica', icon: 'ğŸ§ ', exercises: ['Entrenamiento tÃ¡ctico 45min'] };
                routines[4] = { name: 'Resistencia', icon: 'â¤ï¸', exercises: ['Cardio especÃ­fico 40min'] };
                routines[5] = { name: 'Partido', icon: 'âš½', exercises: ['PrÃ¡ctica completa 90min'] };
                routines[6] = { name: 'RecuperaciÃ³n', icon: 'ğŸ§˜', exercises: ['Yoga/Pilates 30min'] };
            }

            return routines;
        }

        function generateWeeklyGoals(prefs) {
            const totalWeeks = Math.ceil(prefs.duration / 7);
            const goals = [];

            // Default templates (fallback)
            const defaultTemplates = {
                fitness: {
                    fisica: ['Establecer rutina de ejercicio', 'Aumentar intensidad', 'Mejorar resistencia', 'Definir mÃºsculos', 'Alcanzar peso ideal'],
                    personal: ['Aprender sobre nutriciÃ³n', 'Crear rutina de sueÃ±o', 'Gestionar el estrÃ©s', 'Mejorar autoestima', 'Mantener consistencia'],
                    digital: ['Seguir cuentas fitness', 'Documentar progreso', 'Buscar recetas saludables', 'Unirse a comunidad', 'Compartir logros'],
                    espiritual: ['Practicar gratitud', 'MeditaciÃ³n diaria', 'Visualizar metas', 'AutocompasiÃ³n', 'Celebrar victorias']
                },
                learning: {
                    fisica: ['Establecer horario de estudio', 'Descansos activos', 'Cuidar postura', 'Ejercicio para energÃ­a', 'Balance estudio-descanso'],
                    personal: ['Definir objetivos de aprendizaje', 'TÃ©cnicas de estudio', 'PrÃ¡ctica diaria', 'Medir progreso', 'Aplicar conocimientos'],
                    digital: ['Organizar recursos', 'Apps de aprendizaje', 'Comunidad online', 'Certificaciones', 'Portfolio'],
                    espiritual: ['Paciencia con el proceso', 'Celebrar pequeÃ±os logros', 'Mentalidad de crecimiento', 'Gestionar frustraciÃ³n', 'Disfrutar aprender']
                },
                productivity: {
                    fisica: ['Rutina de energÃ­a matutina', 'Pausas activas', 'Ejercicio regular', 'SueÃ±o de calidad', 'AlimentaciÃ³n para energÃ­a'],
                    personal: ['Sistema de productividad', 'Eliminar distracciones', 'Priorizar tareas', 'Delegar', 'Automatizar'],
                    digital: ['Herramientas de productividad', 'Calendario optimizado', 'Inbox zero', 'Limitar redes sociales', 'Tracking de tiempo'],
                    espiritual: ['PropÃ³sito claro', 'Mindfulness', 'Evitar burnout', 'Equilibrio vida-trabajo', 'Gratitud diaria']
                },
                business: {
                    fisica: ['EnergÃ­a para emprender', 'Ejercicio regular', 'GestiÃ³n del estrÃ©s', 'Networking activo', 'Presencia profesional'],
                    personal: ['Definir modelo de negocio', 'Validar idea', 'Primeros clientes', 'Escalar operaciones', 'Liderazgo'],
                    digital: ['Presencia online', 'Marketing digital', 'AutomatizaciÃ³n', 'MÃ©tricas clave', 'Marca personal'],
                    espiritual: ['Resiliencia', 'Manejar incertidumbre', 'VisiÃ³n a largo plazo', 'Celebrar progreso', 'Aprender de errores']
                },
                competition: {
                    fisica: ['PreparaciÃ³n fÃ­sica inicial', 'Intensificar entrenamiento', 'Perfeccionar tÃ©cnica', 'Peak performance', 'DÃ­a de competencia'],
                    personal: ['Investigar competencia', 'Coach/Mentor', 'PrÃ¡ctica deliberada', 'Simulacros', 'Mentalidad ganadora'],
                    digital: ['Estudiar ganadores', 'Documentar preparaciÃ³n', 'Comunidad de apoyo', 'Visibilidad', 'Marca personal'],
                    espiritual: ['VisualizaciÃ³n del Ã©xito', 'Manejo de nervios', 'Confianza', 'Presencia escÃ©nica', 'Disfrutar el proceso']
                },
                wellness: {
                    fisica: ['Movimiento diario', 'AlimentaciÃ³n consciente', 'SueÃ±o reparador', 'Reducir tensiÃ³n', 'EnergÃ­a natural'],
                    personal: ['Autoconocimiento', 'LÃ­mites saludables', 'Relaciones positivas', 'Hobbies', 'Tiempo para ti'],
                    digital: ['Detox digital', 'Apps de bienestar', 'Contenido positivo', 'Comunidad de apoyo', 'Balance online'],
                    espiritual: ['MeditaciÃ³n diaria', 'ConexiÃ³n interior', 'PropÃ³sito de vida', 'Paz mental', 'Plenitud']
                }
            };

            // Use cloud templates if available, otherwise use defaults
            let template = defaultTemplates[prefs.goal] || defaultTemplates.wellness;

            // Override with cloud templates if available
            if (cloudTemplates && cloudTemplates.goals && cloudTemplates.goals[prefs.goal] && cloudTemplates.goals[prefs.goal].metas) {
                const cloudMetas = cloudTemplates.goals[prefs.goal].metas;
                // Cloud templates have single values, use them as the first phase
                if (cloudMetas.fisica) template.fisica[0] = cloudMetas.fisica;
                if (cloudMetas.personal) template.personal[0] = cloudMetas.personal;
                if (cloudMetas.digital) template.digital[0] = cloudMetas.digital;
                if (cloudMetas.espiritual) template.espiritual[0] = cloudMetas.espiritual;
            }

            for (let week = 1; week <= totalWeeks; week++) {
                const progress = (week - 1) / (totalWeeks - 1);
                const phaseIndex = Math.min(4, Math.floor(progress * 5));

                const startDay = (week - 1) * 7 + 1;
                const endDay = Math.min(week * 7, prefs.duration);

                goals.push({
                    week: week,
                    dates: `DÃ­a ${startDay}-${endDay}`,
                    fisica: week === totalWeeks ? `ğŸ¯ ${template.fisica[phaseIndex]}` : template.fisica[phaseIndex],
                    personal: week === totalWeeks ? `ğŸ¯ ${template.personal[phaseIndex]}` : template.personal[phaseIndex],
                    digital: week === totalWeeks ? `ğŸ¯ ${template.digital[phaseIndex]}` : template.digital[phaseIndex],
                    espiritual: week === totalWeeks ? `ğŸ¯ ${template.espiritual[phaseIndex]}` : template.espiritual[phaseIndex]
                });
            }

            return goals;
        }

        // Load cloud templates from backoffice
        async function loadCloudTemplates() {
            try {
                if (typeof supabaseAPI !== 'undefined') {
                    cloudTemplates = await supabaseAPI.getAppTemplates();
                    if (cloudTemplates) {
                        console.log('Cloud templates loaded successfully');
                    }
                }
            } catch (e) {
                console.log('Using default templates');
            }
        }

        // Initialize
        (async function init() {
            await loadCloudTemplates();
            showStep(1);
        })();
    </script>
</body>
</html>
